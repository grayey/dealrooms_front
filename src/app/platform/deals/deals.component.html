<div id="create_deal_overlay" class="overlay">


  <form [formGroup]="createDealForm" (ngSubmit)="createDeal()" id="create_deal_form">


    <div class="container-fluid">

      <div class="card m-b-20">

        <div class="card-header">
          <div class="pull-right">

            <button class="btn  waves-effect btn-lg" type="submit"
                    [disabled]="createDealForm.invalid || loaders?.processing"
                    [ngClass]="setValidationClass(createDealForm.valid)"> {{messages.create}}&nbsp;
              <i class="spinner" *ngIf="loaders?.processing"></i>
              <i class="fa fa-save" *ngIf="!loaders?.processing"></i>
            </button>&nbsp;&nbsp;
            <button role="button" type="button" [disabled]="openingOverlay" class="btn btn-secondary btn-lg "
                    (click)="closeOverlay('create_deal_overlay')">Close
              <i class="fa fa-times" *ngIf="!openingOverlay"></i>
              <i class="fa fa-cog fa-spin" *ngIf="openingOverlay"></i>
            </button>
          </div>

          <h2 class="text-muted">[ Create Deal ]</h2>
        </div>
        <div class="card-body">


          <!--<h4 class="mt-0 header-title">ENTREPRENEUR<small>@if($isAdmin)<b>: {{$user->name}}</b> @endif </small></h4>-->


          <!-- Nav tabs -->
          <ul class="nav nav-pills" role="tablist">
            <li class="nav-item">
              <a class="nav-link active" data-toggle="tab" href="#general" role="tab">General</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" data-toggle="tab" href="#project_overview" role="tab">Project Overview</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" data-toggle="tab" href="#funding_req" role="tab">Funding Requirements</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" data-toggle="tab" href="#financials" role="tab">Financials</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" data-toggle="tab" href="#team_key_challenge" role="tab">Team & Key Challenges</a>
            </li>
            <!--<li class="nav-item">-->
            <!--<a class="nav-link" data-toggle="tab" href="#key_challenge" role="tab">Key Challenges</a>-->
            <!--</li>-->

            <li class="nav-item">
              <a class="nav-link" data-toggle="tab" href="#documents" role="tab">Documents</a>
            </li>
          </ul>

          <!-- Tab panes -->
          <div class="tab-content" style="min-height: 500px;">
            <div class="tab-pane active p-3" id="general" role="tabpanel">


              <div class="row">
                <div class="col-12">
                  <div class="card">
                    <div class="card-body">


                      <p class="text-danger text-center">
                        <!--<b>Provide general project details.</b>-->

                      </p>

                      <div class="form-group row">
                        <label for="example-text-input" class="col-sm-2 col-form-label">Project Name<span
                          class="text-danger">*</span></label>
                        <div class="col-sm-10">
                          <input class="form-control" type="text" formControlName="project_name" name="project_name"
                                 value="" id="example-text-input">
                        </div>
                      </div>
                      <div class="form-group row">
                        <label for="example-text-input" class="col-sm-2 col-form-label">Project Type<span
                          class="text-danger">*</span></label>
                        <div class="col-sm-10">
                          <select class="form-control" formControlName="project_type" name="project_type">
                            <option value="">Select</option>
                            <option value="start_up">
                              Start Up
                            </option>
                            <option value="scale_up">
                              Scale Up
                            </option>
                          </select>
                        </div>
                      </div>
                      <div class="form-group row">
                        <label for="" class="col-sm-2 col-form-label">Location<span class="text-danger">*</span></label>
                        <div class="col-sm-10">
                          <input class="form-control" formControlName="location" type="text" name="location" id="">
                        </div>
                      </div>


                      <div class="form-group row">
                        <label class="col-sm-2 col-form-label">Sector<span class="text-danger">*</span></label>
                        <div class="col-sm-10">
                          <select class="form-control" formControlName="sector_id" (change)=setSector($event) name="sector_id">
                            <option value="">Select</option>
                            <option *ngFor="let sector of allSectors; let i = index" [value]="sector | json">
                              {{sector?.name}}
                            </option>

                          </select>
                        </div>
                      </div>

                      <div class="form-group row">
                        <label class="col-sm-2 col-form-label">Fund Type<span class="text-danger">*</span></label>
                        <div class="col-sm-10">
                          <select class="form-control" formControlName="fund_type_id" name="fund_type_id" (change)="setFundType($event)">
                            <option value="">Select</option>
                            <option *ngFor="let fundType of allFundTypes; let i = index" [value]="fundType | json">
                              {{fundType?.name}}
                            </option>

                          </select>
                        </div>
                      </div>

                      <div class="form-group row">
                        <label class="col-sm-2 col-form-label">Funding Amount ($)<span
                          class="text-danger">*</span></label>
                        <div class="col-sm-10">
                          <input class="form-control" formControlName="funding_amount" name="funding_amount"
                                 type="number" value=""
                                 id="create_funding_amount">

                        </div>
                      </div>
                      <div class="form-group row">
                        <label for="example-email-input" class="col-sm-2 col-form-label">Email<span class="text-danger">*</span></label>
                        <div class="col-sm-10">
                          <input class="form-control" formControlName="email" name="email" type="email" value=""
                                 id="example-email-input">
                        </div>
                      </div>
                      <div class="form-group row">
                        <label for="example-tel-input" class="col-sm-2 col-form-label">Telephone</label>
                        <div class="col-sm-10">
                          <input class="form-control" formControlName="telephone" name="telephone" type="tel" value=""
                                 id="example-tel-input">
                        </div>
                      </div>

                      <div class="form-group row">
                        <label for="example-url-input" class="col-sm-2 col-form-label">Website</label>
                        <div class="col-sm-10">
                          <input class="form-control" formControlName="website" name="website" type="url" value=""
                                 id="example-url-input">
                        </div>
                      </div>


                    </div>
                  </div>
                </div> <!-- end col -->
              </div> <!-- end row -->


            </div>
            <div class="tab-pane p-3" id="project_overview" role="tabpanel">

              <div class="row">
                <div class="col-md-12">

                  <!-- <h4 class="mt-0 header-title">Company/Project Overview</h4> -->
                  <p class="text-danger m-b-30 font-14 text-center ">

                    <!--<b>-->
                    <!--Provide a succinct overview of your organisation-->
                    <!--or project-->
                    <!--using the sample headings provided as much as possible.</b>-->

                  </p>

                  <ul class="nav nav-tabs nav-tabs-custom" role="tablist">
                    <li class="nav-item">
                      <a class="nav-link active" data-toggle="tab" href="#problem_situation_business_model" role="tab">Problem
                        Situation & Business Model</a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" data-toggle="tab" href="#operating_model_target_market" role="tab">Operating
                        Model & Target Market</a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" data-toggle="tab" href="#current_status_achievements_future_plans" role="tab">Current
                        Achievements & Future Plans</a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" data-toggle="tab" href="#competition_revenue_streams" role="tab">Competition &
                        Revenue Stream</a>
                    </li>

                  </ul>

                  <div class="tab-content" style="min-height: 500px;">
                    <div class="tab-pane active p-3" id="problem_situation_business_model" role="tabpanel">

                      <div class="row">

                        <div class="col-md-6">
                          <p class="text-muted"><b>Describe Your Problem Situation</b></p>
                          <input type="text" formControlName="problem_situation" id="problem_situation_value"
                                 name="problem_situation"
                                 style="display: none">
                          <div class="summernote" id="problem_situation_note"></div>
                        </div>
                        <div class="col-md-6 border-left">
                          <p class="text-muted"><b>Describe your Business Model</b></p>
                          <input type="text" formControlName="business_model" id="business_model_value"
                                 name="business_model" style="display: none">
                          <div class="summernote" id="business_model_note"></div>
                        </div>
                      </div>
                    </div>
                    <div class="tab-pane p-3" id="operating_model_target_market" role="tabpanel">

                      <div class="row">

                        <div class="col-md-6">
                          <p class="text-muted"><b>Describe Operating Model</b></p>
                          <input type="text" formControlName="operating_model" id="operating_model_value"
                                 name="operating_model" style="display: none">
                          <div class="summernote" id="operating_model_note"></div>
                        </div>
                        <div class="col-md-6 border-left">
                          <p class="text-muted"><b>Describe Target Market</b></p>
                          <input type="text" formControlName="target_market" id="target_market_value"
                                 name="target_market" style="display: none">
                          <div class="summernote" id="target_market_note"></div>
                        </div>
                      </div>

                    </div>
                    <div class="tab-pane p-3" id="current_status_achievements_future_plans" role="tabpanel">
                      <div class="row">

                        <div class="col-md-6">
                          <p class="text-muted"><b>Describe Current Status/Achievements</b></p>
                          <input type="text" formControlName="current_status_achievements" id="current_status_value"
                                 name="current_status_achievements"
                                 style="display: none">
                          <div class="summernote" id="current_status_note"></div>
                        </div>
                        <div class="col-md-6 border-left">
                          <p class="text-muted"><b>Describe your Future Plans</b></p>
                          <input type="text" formControlName="future_plans" id="future_plans_value" name="future_plans"
                                 style="display: none">
                          <div class="summernote" id="future_plans_note"></div>
                        </div>
                      </div>
                    </div>
                    <div class="tab-pane p-3" id="competition_revenue_streams" role="tabpanel">
                      <div class="row">

                        <div class="col-md-6">
                          <p class="text-muted"><b>Describe Competition</b></p>
                          <input type="text" formControlName="competition" id="competition_value" name="competition"
                                 style="display: none">
                          <div class="summernote" id="competition_note"></div>
                        </div>
                        <div class="col-md-6 border-left">
                          <p class="text-muted"><b>Describe Revenue Streams</b></p>
                          <input type="text" formControlName="revenue_streams" id="revenue_streams_value"
                                 name="revenue_streams" style="display: none">
                          <div class="summernote" id="revenue_streams_note"></div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

            </div>
            <div class="tab-pane p-3" id="financials" role="tabpanel">
              <div class="row">
                <div class="col-md-12">
                  <p class="text-danger m-b-30 font-14 ">
                    <!--<b>Key Challenges.</b>-->
                  </p>
                  <input type="text" formControlName="financials" id="financial_value" name="financials"
                         style="display: none">
                  <div class="summernote" id="financial_note"></div>
                </div>
                <!--<div class="col-md-6 border-left">-->
                <!--<p class="text-muted"><b>Upload Financial Document (optional)</b></p>-->
                <!--<div class="m-b-30">-->
                <!--<form action="#" class="dropzone">-->
                <!--<div class="fallback">-->
                <!--<input name="file" type="file" multiple="multiple">-->
                <!--</div>-->
                <!--</form>-->
                <!--</div>-->
                <!--</div>-->


              </div>
            </div>
            <div class="tab-pane p-3" id="funding_req" role="tabpanel">
              <div class="row">
                <div class="col-md-12">

                  <!-- <h4 class="mt-0 header-title">Company/Project Overview</h4> -->
                  <p class="text-danger m-b-30 font-14 text-center ">
                    <!--<b>Describe Funding Requirements.</b>-->
                  </p>

                  <ul class="nav nav-tabs nav-tabs-custom" role="tablist">
                    <li class="nav-item">
                      <a class="nav-link active" data-toggle="tab" href="#amount_fund_usage" role="tab">Usage of
                        Funds</a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" data-toggle="tab" href="#fund_infused_current_indicative" role="tab">Funds
                        Infused (Current Indicative Valuation) & Ownership Structure</a>
                    </li>


                  </ul>

                  <div class="tab-content" style="min-height: 500px;">
                    <div class="tab-pane active p-3" id="amount_fund_usage" role="tabpanel">

                      <div class="row">

                        <div class="col-md-12 pb-3">
                          <div class="row">
                            <div class="col-md-1">
                              <p class="text-muted"><b>Summary:</b></p>
                            </div>
                            <div class="col-md-6">
                              <p style="border: 2px dashed grey; padding: 5px">
                                <em *ngIf="createDealForm?.value?.funding_amount">USD <b>{{createDealForm?.value?.funding_amount
                                  | number}}</b></em>  <em *ngIf="createDealForm?.value?.fund_type_id"> {{selectedFundType?.name?.toLowerCase()?.startsWith('eq') ? 'and offering':'as'}}  <b>{{selectedFundType?.name |titlecase}} </b></em> <em *ngIf="createDealForm?.value?.project_type"> for {{isVowel ?'an':'a'}}
                                {{selectedSector?.name|titlecase}} {{createDealForm?.value?.project_type | removeUnderscore |titlecase}}</em>
                              </p>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12">
                          <p class="text-muted"><b>Describe how funds will be used.</b></p>
                          <input type="text" formControlName="fund_usage" id="fund_usage_value" name="fund_usage"
                                 style="display: none">
                          <div class="summernote" id="fund_usage_note"></div>
                        </div>
                      </div>
                    </div>
                    <div class="tab-pane p-3" id="fund_infused_current_indicative" role="tabpanel">

                      <div class="row">

                        <div class="col-md-6">
                          <p class="text-muted"><b>Describe funds infused into the business or current indicative
                            valuation</b></p>
                          <input type="text" formControlName="fund_infused_current_indicative"
                                 id="fund_infused_current_indicative_value" name="operating_model"
                                 style="display: none">
                          <div class="summernote" id="fund_infused_current_indicative_note"></div>
                        </div>
                        <div class="col-md-6 border-left">
                          <p class="text-muted"><b>Describe Ownership Structure</b></p>
                          <input type="text" formControlName="ownership_structure" id="ownership_structure_value"
                                 name="operating_model"
                                 style="display: none">
                          <div class="summernote" id="ownership_structure_note"></div>
                        </div>
                      </div>

                    </div>

                  </div>
                </div>
              </div>
            </div>
            <div class="tab-pane p-3" id="team_key_challenge" role="tabpanel">
              <div class="row">
                <div class="col-md-6">

                  <!-- <h4 class="mt-0 header-title">Company/Project Overview</h4> -->
                  <p class="text-muted m-b-30 font-14 ">
                    <b>Team Description.</b>
                  </p>

                  <input type="text" formControlName="team" id="team_value" name="team" style="display: none">

                  <div class="summernote" id="team_note"></div>
                </div>
                <div class="col-md-6 border-left">
                  <input type="text" formControlName="key_challenges" id="key_challenge_value" name="key_challenges"
                         style="display: none">

                  <!-- <h4 class="mt-0 header-title">Company/Project Overview</h4> -->
                  <p class="text-muted m-b-30 font-14 ">
                    <b>Key Challenges.</b>
                  </p>

                  <div class="summernote" id="key_challenge_note"></div>
                </div>
              </div>
            </div>

            <div class="tab-pane p-3" id="documents" role="tabpanel">

              <p class="text-danger m-b-30 font-14 ">
                <!--<b>Team Description.</b>-->
              </p>
              <div class="row">
                <div class="col-md-5">

                  <div class="card">

                    <div class="card-header">
                      <h4>Add Document</h4>
                    </div>

                    <div class="card-body">
                      <div class="row">
                        <div class="col-md-12">
                          <div class="form-group">
                            <label>Document Name</label>
                            <!--<input type="text" #document_name class="form-control" id="document_name"-->
                                   <!--placeholder="e.g, Financials">-->

                            <select class="form-control" #document_name  name="document_name" id="document_name">
                              <option value="">Select Document</option>
                              <option value="doc?.name" *ngFor="let doc of allDocsToUpload">
                            {{doc?.name}}
                              </option>
                            </select>

                          </div>

                          <div class="form-group">
                            <label>Upload File</label>


                            <div class="custom-file">
                              <input type="file" class="custom-file-input mt-3"
                                     id="document_file" accept=".xlsx,.xls,.pdf,.doc,.docx"
                                     (change)="uploadFile($event, true)">
                              <label class="custom-file-label" for="document_file">{{manualPaymentFileName}}</label>
                            </div>
                          </div>
                        </div>

                        <!--<div class="col-md-6 card-lined-small scanned-preview">-->

                        <!--<img [src]="manualPaymentFileUrl" alt="">-->

                        <!--</div>-->

                      </div>
                      <div class="mt-3 mr-3" *ngIf="uploadInProgress">
                        <div class="progress">
                          <div [ngClass]="setProgressStatus(percentageUpload)" role="progressbar"
                               [ngStyle]="setProgressBar(percentageUpload)" aria-valuenow="50" aria-valuemin="0"
                               aria-valuemax="100">
                            {{percentageUpload}}
                          </div>
                        </div>
                        <div>
                          {{percentageInFraction}}
                          <small class="text-{{percentageUpload !== '100%'?'info':'success'}}"><b>complete</b></small>
                        </div>
                      </div>

                    </div>
                    <div class="card-footer">
                      <button class="btn waves-effect pull-right"
                              (click)="uploadDocumentFile(document_name.value)"
                              [disabled]="!manualPaymentFileName || !document_name.value || uploadInProgress"
                              [ngClass]="setValidationClass(manualPaymentFileName && document_name.value)">
                        <i class="fa fa-plus" *ngIf="!uploadInProgress"></i>
                        <i class="fa fa-cog fa-spin" *ngIf="uploadInProgress"></i>
                        Add
                      </button>
                    </div>
                  </div>


                </div>
                <div class="col-md-7 border-left">
                  <div class="card" style="min-height: 340px">
                    <div class="card-header">
                      <h4>
                        Documents List
                      </h4>
                    </div>

                    <div class="card-body">
                      <div class="table">
                        <table id="create_documents_table" class="table table-striped table-hover table-bordered ">
                          <thead>
                          <tr>
                            <th>Name</th>
                            <th>Doc Type</th>
                            <th>Date Created</th>
                            <th>Action</th>
                          </tr>
                          </thead>
                          <tbody>
                          <tr *ngIf="allDocuments?.length == 0">
                            <td colspan="4" class="text-center">No documents available</td>

                          </tr>
                          <tr *ngFor="let doc of allDocuments; let i = index">

                            <td>{{doc?.name}}</td>
                            <td>
                              <i class="fa fa-2x fa-file-{{doc?.icon}}"></i>
                            </td>
                            <td>{{doc?.created_at |date:'mediumDate'}}</td>
                            <td>
                              <div class="btn-group button btn btn-sm btn-info"><i class="fa fa-eye"></i></div>
                              <div class="btn-group button btn btn-sm btn-danger"><i class="fa fa-times"></i></div>
                            </td>

                          </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>

                    <div class="card-footer">
                      <div class="row">
                        <div class="col-md-10"></div>
                        <div class="col-md-2"><h6><em>{{allDocuments?.length}} file(s)</em></h6></div>

                      </div>
                    </div>
                  </div>
                </div>
              </div>

            </div>


          </div>

        </div> <!-- Page content Wrapper -->
        <div class="card-footer" style="bottom: 0">
          <div class="pull-right">
            <img class=" modal-logo" src="assets/front/img/app_logo.png">

          </div>
        </div>
      </div>
    </div>
  </form>


</div>
<div id="view_activities_modal" class="modal fade" tabindex="-1" deal="dialog"
     aria-labelledby="view_activities_modalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-lg">


    <div class="modal-content">
      <div class="modal-header">

        <h5 class="modal-title mt-2 ml-5" id="view_activities_modalLabel">Viewing Interests for: <b><em>{{viewedDealForActivity?.project_name}}</em></b>
        </h5>
        <button type="button" class="close " data-dismiss="modal" aria-hidden="true"><i class="fa fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="table-responsive">
          <table id="interested_dealers_table" class="table table-striped table-sm table-hover table-bordered" cellspacing="0" width="100%">
            <thead>
            <tr>
              <th>Name</th>
              <!--<th>Portfolio</th>-->
              <th>Interest</th>
              <ng-container
                *ngIf="(authUser && !authUser?.user_type?.includes('admin') && !authUser?.user_type?.includes('financier'))">
                <th><em>Operation <i class="fa fa-cogs"></i></em></th>
              </ng-container>
            </tr>
            </thead>
            <tbody>
            <!--<tr *ngFor="let interestedDealer of interestedDealers; let i=index">-->
              <!--<td>-->


                <!--<img src="{{interestedDealer?.user?.business_logo || 'assets/images/small/img-3.jpg'}}" alt="user-image"-->
                     <!--class="thumb-sm rounded-circle mr-2"/>-->

                <!--<a href="javascript:void(0)" (click)="findFinancier(interestedDealer?.user?.user_ref)" >-->
                  <!--{{interestedDealer?.user?.dealowner_profile-->
                  <!--? interestedDealer?.user?.dealowner_profile?.name :-->
                  <!--interestedDealer?.user?.financier_runner_profile ?-->
                  <!--interestedDealer?.user?.financier_runner_profile?.company_name-->
                  <!--:-->
                  <!--interestedDealer?.user?.full_name }}-->

                  <!--<sup *ngIf="interestedDealer?.user?.id == authUser?.id"><span class="badge badge-danger">You</span></sup>-->
                <!--</a>-->
              <!--</td>-->
              <!--<td>{{interestedDealer?.user?.user_type| removeUnderscore |titlecase}}</td>-->
              <!--<td>-->
                <!--<span *ngIf="interestedDealer?.watching" class="badge-purple badge">watching <i-->
                  <!--class="mdi mdi-heart"></i></span>&nbsp;-->
                <!--<span *ngIf="interestedDealer?.accessing===1" class="badge-warning badge text-white">accessing <i-->
                  <!--class="mdi mdi-key"></i></span>&nbsp;-->
                <!--<span *ngIf="interestedDealer?.investing" class="badge-success badge">investing <i-->
                  <!--class="fa fa-thumbs-up"></i></span>-->

              <!--&nbsp;  <span class="badge-dark badge"-->
                      <!--*ngIf="viewedDealForActivity?.assigned?.includes(interestedDealer?.user?.id)">{{viewedDealForActivity?.closed_by?.id == interestedDealer?.user?.id || interestedDealer?.temp_closed  ? 'closing' : 'awaiting'}}-->
                                            <!--<i class="fa fa-handshake"></i>-->

                                        <!--</span>-->
              <!--</td>-->

              <!--<ng-container-->
                <!--*ngIf="(authUser && !authUser?.user_type?.includes('admin') && !authUser?.user_type?.includes('financier'))">-->
                <!--<td>-->
                  <!--&lt;!&ndash;<select name="" id="" (change)="grantUserAccess($event,viewedDealForActivity,interestedDealer)"&ndash;&gt;-->
                          <!--&lt;!&ndash;id="gt_access{{i}}">&ndash;&gt;-->
                    <!--&lt;!&ndash;<option value="" disabled>Not Available</option>&ndash;&gt;-->
                    <!--&lt;!&ndash;<option value="1" [selected]="interestedDealer?.accessing === 1">Enabled</option>&ndash;&gt;-->
                    <!--&lt;!&ndash;<option value="2" [selected]="interestedDealer?.accessing === 2">Disabled</option>&ndash;&gt;-->
                  <!--&lt;!&ndash;</select>&ndash;&gt;-->

                  <!--<select name="" id=""-->
                          <!--(change)="grantUserAccess($event,viewedDealForActivity,interestedDealer)"-->
                          <!--id="gt_access{{i}}">-->
                    <!--<option value="" disabled>Not Available</option>-->
                    <!--<option value="1" [disabled]="interestedDealer?.investing"-->
                            <!--[selected]="interestedDealer?.accessing === 1">Enable Access-->
                    <!--</option>-->
                    <!--<option value="2" [disabled]="interestedDealer?.investing"-->
                            <!--[selected]="interestedDealer?.accessing === 2">Disable Access-->
                    <!--</option>-->

                    <!--<option value="3" [disabled]="viewedDealForActivity?.closed_by" *ngIf="interestedDealer?.investing">Close Deal</option>-->

                  <!--</select>-->
                  <!--<div *ngIf="interestedDealer?.toggling">-->
                    <!--<span class="text-dark blinking badge badge-default"-->
                    <!--&gt;{{interestedDealer?.toggling}}</span>-->
                  <!--</div>-->
                <!--</td>-->
              <!--</ng-container>-->
            <!--</tr>-->

            <tr *ngFor="let interestedDealer of interestedDealers; let i=index">
              <td>


                <img
                  src="{{interestedDealer?.user?.business_logo || 'assets/images/small/img-3.jpg'}}"
                  alt="user-image"
                  class="thumb-sm rounded-circle mr-2"/>

                <a href="javascript:void(0)"
                   (click)="findFinancier(interestedDealer?.user?.user_ref)">
                  {{interestedDealer?.user?.dealowner_profile
                  ? interestedDealer?.user?.dealowner_profile?.name :
                  interestedDealer?.user?.financier_runner_profile ?
                  interestedDealer?.user?.financier_runner_profile?.company_name
                  :
                  interestedDealer?.user?.full_name }}

                  <sup *ngIf="interestedDealer?.user?.id == authUser?.id"><span
                    class="badge badge-danger">You</span></sup>
                </a>
              </td>
              <td>
                <!--<span *ngIf="interestedDealer?.watching || interestedDealer?.user_is_watching"-->
                <!--class="badge-purple badge">watching <i-->
                <!--class="mdi mdi-heart"></i></span>&nbsp;-->
                <!--<span *ngIf="interestedDealer?.accessing===1"-->
                <!--class="badge-warning badge text-white">accessing <i-->
                <!--class="mdi mdi-key"></i></span>&nbsp;-->
                <!--<span *ngIf="interestedDealer?.investing" class="badge-success badge">investing <i-->
                <!--class="fa fa-thumbs-up"></i></span>&nbsp;-->

                <!--<span class="badge-dark badge"-->
                <!--*ngIf="viewedDeal?.assigned?.includes(interestedDealer?.user?.id)">-->

                <!--Handshake-->
                <!--&lt;!&ndash;{{viewedDeal?.closed_by?.id == interestedDealer?.user?.id || interestedDealer?.temp_closed  ? 'Closed' : 'Awaiting'}}&ndash;&gt;-->
                <!--<i class="fa fa-handshake"></i>-->

                <!--</span>-->
                <!--&nbsp;-->

                <!--<span class="badge-primary badge"-->
                <!--*ngIf="viewedDeal?.closed?.includes(interestedDealer?.user?.id)">-->
                <!--Closed-->
                <!--<i class="fa fa-angle-double-down"></i>-->

                <!--</span>-->


                <div class="progress">

                  <div class="progress-bar progress-bar-striped progress-bar-animated text-white"
                       role="progressbar"
                       [ngClass]="interestedDealer?.progress_info?.progress_class" role="progressbar"
                       [ngStyle]="interestedDealer?.progress_info?.progress_bar" aria-valuenow="0"
                       aria-valuemin="0"
                       aria-valuemax="100">

                    {{interestedDealer?.progress_info?.percentage}}%

                  </div>



                </div>

                <div>

                  <span [innerHTML]="interestedDealer?.progress_info?.progress_label"></span>
                </div>
              </td>

              <ng-container
                *ngIf="(authUser && !authUser?.user_type?.includes('admin') && !authUser?.user_type?.includes('financier') &&
                                        authUser?.id == viewedDealForActivity?.user?.id)">
                <td>
                  <ng-container
                    *ngIf="!viewedDealForActivity?.assigned?.includes(interestedDealer?.user?.id) && !viewedDealForActivity?.closed_by && !interestedDealer?.closing">
                    <select name="" id=""
                            (change)="grantUserAccess($event,viewedDealForActivity,interestedDealer)"
                            id="gt_access{{i}}">
                      <option value="" disabled>Not Available</option>
                      <option value="1" [disabled]="interestedDealer?.investing"
                              [selected]="interestedDealer?.accessing === 1">Enable Access
                      </option>
                      <option value="2" [disabled]="interestedDealer?.investing"
                              [selected]="interestedDealer?.accessing === 2">Disable Access
                      </option>

                      <option value="3" *ngIf="interestedDealer?.investing">Close Deal</option>

                    </select>
                    <div *ngIf="interestedDealer?.toggling">
                    <span class="text-dark blinking badge badge-default"
                    >{{interestedDealer?.toggling}}</span>
                    </div>
                  </ng-container>

                  <ng-container
                    *ngIf="interestedDealer?.assigned || viewedDealForActivity?.closed_by">

                    <span class="badge badge-default">{{'Unavailable'}}</span>

                  </ng-container>


                </td>
              </ng-container>
            </tr>
            </tbody>
          </table>



        </div>

      </div>
      <div class="modal-footer">


        <div *ngIf="dealLevelMsg"
             class="alert pull-left bg-{{dealLevelMsg?.includes('level 2') ? 'warning':'info'}} text-white alert-dismissible fade show"
             role="alert">
          <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
          <strong>Note:</strong> {{dealLevelMsg}}.
        </div>

        <button type="button" class="btn btn-secondary waves-effect" data-dismiss="modal">Close</button>


        <!--<img class="  pull-left" src="assets/front/img/app_logo.png">-->


      </div>
    </div><!-- /.modal-content -->


  </div><!-- /.modal-dialog -->

</div><!-- /.modal -->


<div class="header-bg top-white">
  <div class="ml-4 mr-5">
    <!-- Page-Title -->
    <div class="row">
      <div class="col-sm-12">
        <div class="page-title-box">

          <!--<form class="float-right app-searchx">-->

            <!--<ng-container *ngIf="userIsDealRunnerOrOwner">-->
              <!--<button class="btn btn-light btn text-dark" type="button"-->
                      <!--(click)="openOverlay('create_deal_overlay')" [disabled]="openingOverlay">-->
                <!--<i class="dripicons-plus" *ngIf="!openingOverlay"></i>-->
                <!--<i class="fa fa-cog fa-spin" *ngIf="openingOverlay"></i> Create Deal-->
              <!--</button>-->

            <!--</ng-container>-->
          <!--</form>-->
          <!--<app-search-filter></app-search-filter>-->
          <h4 class="page-title no_button"><i class="ion-briefcase"></i>{{userType=='admin' ? 'All':'My' }}
            {{userType=='financier'?'Interests':'Deals'}}</h4>
        </div>
      </div>
    </div>
    <!-- end page title end breadcrumb -->
  </div>
</div>

<div class="wrapper">
  <div class="ml-2 mr-2">


    <div class="row">
      <div class="col-12">
        <div class="card m-b-20">
          <div class="card-body">

            <div class="table-responsive">

              <table id="deals_table" class="table table-striped table-sm table-hover table-bordered mt-3" cellspacing="0" width="100%">
                <thead>
                <tr>


                  <th class="border-right-0"></th>
                  <th>Business Name</th>
                  <th>Project Name</th>
                  <th>Date Initiated</th>
                  <th>Sector</th>
                  <th>($) Amount</th>
                  <th>Fund Type</th>

                  <th>Interests</th>
                  <th>{{authUser?.user_type == 'admin' ? '' :'My'}} Progress</th>

                  <ng-container *ngIf="!userIsDealRunnerOrOwner">

                    <th>Owner</th>
                    <th>Portfolio</th>
                  </ng-container>

                  <th>Status</th>
                  <th>Action</th>
                </tr>
                </thead>


                <tbody>

                <tr *ngIf="loaders?.processing || allDeals?.length===0">
                  <td [attr.colspan]="userIsDealRunnerOrOwner ? '11':'13'" class="text-center"
                      *ngIf="loaders?.processing">
                    <div class="spinner"></div>
                  </td>
                  <td [attr.colspan]="userIsDealRunnerOrOwner ? '11':'13'" class="text-center"
                      *ngIf="(!loaders?.processing &&  allDeals?.length===0) ">
                    No deals available.
                  </td>
                </tr>

                <tr *ngFor="let deal of allDeals; let i=index">
                  <td class="border-right-0">
                    <img src="{{ deal?.user?.business_logo || 'assets/images/small/img-3.jpg' }}" alt="business-logo" class="thumb-sm rounded-circle mr-2"/>

                  </td>


                  <td>

                    {{deal?.user?.dealowner_profile ? deal?.user?.dealowner_profile?.name : deal?.user?.financier_runner_profile ? deal?.user?.financier_runner_profile?.company_name : '----' }}


                  </td>

                  <td>
                    <a routerLink="../deals/{{deal?.slug}}">

                    {{deal?.project_name}}
                    <br>
                    <span class="text-white badge badge-{{deal?.project_type =='start_up'?'info':'secondary'}}">{{deal?.project_type| removeUnderscore |titlecase}}</span>
                    </a>
                  </td>

                  <td>
                    {{deal?.created_at | date:'mediumDate'}}
                  </td>

                  <td>
                    <div class="shorten">{{deal?.sector?.name}}</div>
                  </td>
                  <td >{{deal?.funding_amount | number |summarize}}</td>
                  <td>
                    <div class="shorten">
                    {{deal?.fund_type?.name}}
                  </div>
                  </td>



                  <td>
                    <div class="{{deal?.process_interests ? 'spinner':'activities_div'}}"
                         (click)="viewDealActivities(deal)">
                      <span class="btn badge badge-purple activity_badge"><small><b>watching <i class="mdi mdi-heart"></i> &nbsp;({{deal?.watchers?.length |number}})</b></small></span>
                      <br>
                      <span class="btn badge text-white badge-warning activity_badge"> <small><b>accessing <i class="mdi mdi-key"></i> &nbsp;({{deal?.accessors?.length |number}})</b></small></span>

                      <br>
                      <span class="btn badge text-white badge-success activity_badge"> <small><b>investing <i
                        class="fa fa-thumbs-up"></i> &nbsp;({{deal?.investors?.length |number}})</b></small></span>
                      <br>

                      <span class="btn badge text-white badge-dark activity_badge"> <small><b>Handshake <i
                        class="fa fa-handshake"></i> &nbsp;({{deal?.assigned?.length |number}})</b></small></span>
                      <br>

                      <span class="btn badge text-white badge-primary activity_badge"> <small><b>Complete <i
                        class="fa fa-angle-double-down"></i> &nbsp;({{deal?.closed?.length |number}})</b></small></span>

                    </div>

                    <div class="blinking" *ngIf="deal?.process_interests"><span
                      class="badge badge-default">fetching</span></div>


                  </td>




                  <td>

                    <ng-container *ngIf="(authUser?.user_type == 'admin' || authUser?.id == deal?.user?.id)">
                      <div class="progress">
                        <div class="progress-bar progress-bar-striped progress-bar-animated text-white" role="progressbar"
                             [ngClass]="setDealProgressStatus(deal?.stage?.step)" role="progressbar"
                             [ngStyle]="setDealProgressBar(deal?.stage?.percentage)" aria-valuenow="0" aria-valuemin="0"
                             aria-valuemax="100">

                          {{deal?.stage?.percentage}}%

                        </div>
                      </div>
                      <div>

                        <span class="badge badge-default text-dark">{{deal?.stage?.name}}: <small><em>Stage {{deal?.stage?.step}}</em></small></span>

                      </div>
                    </ng-container>

                    <ng-container *ngIf="authUser && (authUser?.user_type == 'financier')">
                      <div class="progress">

                        <div class="progress-bar progress-bar-striped progress-bar-animated text-white"
                             role="progressbar"
                             [ngClass]="deal?.progress_info?.progress_class" role="progressbar"
                             [ngStyle]="deal?.progress_info?.progress_bar" aria-valuenow="0"
                             aria-valuemin="0"
                             aria-valuemax="100">

                          {{deal?.progress_info?.percentage}}%

                        </div>



                      </div>

                      <div>

                        <span [innerHTML]="deal?.progress_info?.progress_label"></span>
                      </div>
                    </ng-container>


                  </td>

                  <ng-container *ngIf="!userIsDealRunnerOrOwner">


                    <td>{{deal?.user?.full_name}}</td>


                    <td>{{deal?.user?.user_type| removeUnderscore  |titlecase}}</td>

                  </ng-container>

                  <td>
                    <!--{{deal?.status}}-->
                    <div class="text-center">

                      <ng-container *ngIf="(authUser && authUser?.user_type?.includes('admin'))">
                        <select class="form-controlx" (change)="toggleDeal($event,deal)" id="deal_item{{i}}">
                          <option value="0" [selected]="deal?.status==0" class="text-danger">Inactive</option>
                          <option value="1" [selected]="deal?.status==1" class="text-success">Open</option>
                          <option value="2" [selected]="deal?.status==2" class="text-info">Closed</option>
                        </select>
                        <br>

                        <span [ngClass]="setClass(deal?.status)"
                              *ngIf="!deal?.toggling">{{dealLabel(deal?.status)}}</span>
                        <span class="text-dark blinking badge badge-default"
                              *ngIf="deal?.toggling">{{deal?.toggling}}</span>

                      </ng-container>

                      <ng-container *ngIf="(authUser && !authUser?.user_type?.includes('admin'))">
                         <span [ngClass]="setClass(deal?.status)"
                               *ngIf="!deal?.toggling">{{dealLabel(deal?.status)}}</span>
                      </ng-container>


                    </div>
                  </td>
                  <td>


                    <div class="btn-group m-b-10">
                      <button type="button" class="btn btn-sm btn-secondary">Manage</button>
                      <button type="button" class="btn btn-sm btn-secondary  dropdown-toggle dropdown-toggle-split"
                              data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span class="sr-only"><i class="fa fa-cog"></i></span>
                      </button>
                      <div class="dropdown-menu">
                        <a class="dropdown-item" routerLink="./{{deal?.slug}}"><em> view deal </em> <i class="mdi mdi-eye"></i></a>

                        <ng-container
                          *ngIf="(authUser && !authUser?.user_type?.includes('admin') && !authUser?.user_type?.includes('financier'))">
                          <a class="dropdown-item" routerLink="./update/{{deal?.slug}}" ><em> edit
                            deal </em> <i
                            class="fa fa-pencil"></i></a>
                        </ng-container>
                        <a class="dropdown-item" (click)="viewDealActivities(deal)" style="cursor: pointer"><em> view
                          interests </em> <i class="mdi mdi-eye"></i></a>

                      </div>
                    </div>
                  </td>

                </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div> <!-- end col -->
    </div> <!-- end row -->

  </div> <!-- end container -->
</div>
